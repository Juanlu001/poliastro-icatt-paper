\section{Python as a core computational language}
\label{sec:python}

The Python programming language is a fast-growing language both for astronomic applications\cite{2015arXiv150703989M} and for educational purposes\cite{guo2014python}, but it is often criticized for its suboptimal performance and lack of type enforcement.

\subsection{Language features}

%\subsection{Vectorizing operations with NumPy}  % Should this be a subsection?

\subsection{Just-in-time compilation using numba}

As we have seen in previous sections, while it is possible to use NumPy to vectorize certain kinds of numerical operations, there might be other cases where this is not possible and where the dynamic nature of Python leads to a performance penalty, specially when the algorithm involves several levels of nested looping. To overcome these limitations we used numba, an open source library which takes array-oriented and math-heavy Python code and generates optimized machine code using the LLVM compiler infrastructure\cite{numba}.

\subsection{Benchmarks against Fortran}

To test the suitability of Python and numba for writing expensive mathematical algorithms in terms of performance and legibility we compare two algorithms for solving Lambert's problem: a simple bisection iteration over an universal variable as presented in \cite{bate1971fundamentals} and \cite{vallado2001fundamentals} (from now on, referred to as BMW-Vallado algorithm) and the more recent algorithm by \cite{Izzo2014}, based on a Householder iteration scheme over a Lambert-invariant variable (see \cite{gooding1990procedure} for the definition). These two algorithms are very different in nature: the former favors a simple approach that is robust and simple to implement, while the latter employs clever analytical transformations and a higher order root finding method to converge in very few iterations, hence using fewer function evaluations. Also, the former works only for single revolution solutions, whereas the latter can also find solutions corresponding to multiple revolutions.

% May we add some math here?

Both algorithms implemented in Python and accelerated using numba are present in poliastro, a MIT-licensed open source library dedicated to problems focused on interplanetary Astrodynamics problems, such as orbit propagation, solution of Lambert's problem, conversion between position and velocity vectors and classical orbital elements and orbit plotting. poliastro documentation and source code are available online\footnote{https://github.com/poliastro/poliastro}\footnote{http://poliastro.readthedocs.org/en/v0.5.0/}.

\subsubsection{Bate-Mueller-White-Vallado algorithm}

Several implementations of the BMW-Vallado algorithm are freely available on the Internet as the companion software of Vallado's book\footnote{http://celestrak.com/software/vallado-sw.asp}, and the Fortran version was incorporated in poliastro 0.2 and distributed under the same terms with explicit permission of the author (see \ref{sec:interface} for discussion on calling Fortran functions from Python). In poliastro 0.3 the algorithm was translated to Python and accelerated with numba.

% I should add a table and/or a figure here with these results

\subsubsection{Izzo algorithm}

For the preparation of this paper, we also implemented the Izzo algorithm.

\subsection{Gradual typing}